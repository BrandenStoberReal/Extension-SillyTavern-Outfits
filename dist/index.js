(()=>{"use strict";var e={16:(e,t,n)=>{n.d(t,{A:()=>a});var o=n(601),i=n.n(o),s=n(314),r=n.n(s)()(i());r.push([e.id,'/* Basic styling for the Outfit Extension */\n\n#outfit-extension-settings {\n    padding: 15px;\n    border-top: 1px solid #4a4a4a;\n}\n\n#outfit-extension-settings .inline-help {\n    margin-bottom: 15px;\n    color: #ccc;\n}\n\n#outfit-extension-settings .checkbox-nested {\n    margin-bottom: 10px;\n}\n\n#outfit-extension-settings label.checkbox {\n    display: flex;\n    align-items: center;\n    cursor: pointer;\n}\n\n#outfit-extension-settings label.checkbox input[type="checkbox"] {\n    margin-right: 8px;\n}\n\n/* Add any other outfit extension specific styles here */',""]);const a=r},314:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",o=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),o&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),o&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,o,i,s){"string"==typeof e&&(e=[[null,e,void 0]]);var r={};if(o)for(var a=0;a<this.length;a++){var c=this[a][0];null!=c&&(r[c]=!0)}for(var l=0;l<e.length;l++){var d=[].concat(e[l]);o&&r[d[0]]||(void 0!==s&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=s),n&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=n):d[2]=n),i&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=i):d[4]="".concat(i)),t.push(d))}},t}},601:e=>{e.exports=function(e){return e[1]}},72:e=>{var t=[];function n(e){for(var n=-1,o=0;o<t.length;o++)if(t[o].identifier===e){n=o;break}return n}function o(e,o){for(var s={},r=[],a=0;a<e.length;a++){var c=e[a],l=o.base?c[0]+o.base:c[0],d=s[l]||0,u="".concat(l," ").concat(d);s[l]=d+1;var f=n(u),p={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==f)t[f].references++,t[f].updater(p);else{var g=i(p,o);o.byIndex=a,t.splice(a,0,{identifier:u,updater:g,references:1})}r.push(u)}return r}function i(e,t){var n=t.domAPI(t);n.update(e);return function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,i){var s=o(e=e||[],i=i||{});return function(e){e=e||[];for(var r=0;r<s.length;r++){var a=n(s[r]);t[a].references--}for(var c=o(e,i),l=0;l<s.length;l++){var d=n(s[l]);0===t[d].references&&(t[d].updater(),t.splice(d,1))}s=c}}},659:e=>{var t={};e.exports=function(e,n){var o=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(n)}},540:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},56:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},825:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var o="";n.supports&&(o+="@supports (".concat(n.supports,") {")),n.media&&(o+="@media ".concat(n.media," {"));var i=void 0!==n.layer;i&&(o+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),o+=n.css,i&&(o+="}"),n.media&&(o+="}"),n.supports&&(o+="}");var s=n.sourceMap;s&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),t.styleTagTransform(o,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},113:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}}},t={};function n(o){var i=t[o];if(void 0!==i)return i.exports;var s=t[o]={id:o,exports:{}};return e[o](s,s.exports,n),s.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.nc=void 0;var o=n(72),i=n.n(o),s=n(825),r=n.n(s),a=n(659),c=n.n(a),l=n(56),d=n.n(l),u=n(540),f=n.n(u),p=n(113),g=n.n(p),v=n(16),m={};m.styleTagTransform=g(),m.setAttributes=d(),m.insert=c().bind(null,"head"),m.domAPI=r(),m.insertStyleElement=f();i()(v.A,m);v.A&&v.A.locals&&v.A.locals;var h=function(e,t,n,o){return new(n||(n=Promise))((function(i,s){function r(e){try{c(o.next(e))}catch(e){s(e)}}function a(e){try{c(o.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}c((o=o.apply(e,t||[])).next())}))};const y="Outfit Extension",x=()=>h(void 0,void 0,void 0,(function*(){try{const e=yield fetch(API_ROOT_URL+ApiEndpoints.Register,{method:HttpMethod.POST,headers:{"Content-Type":HttpContentType.JSON},body:JSON.stringify({extensionId:EXTENSION_ID})}),t=yield e.json();if(404===e.status)return void console.error("Value Tracker not found or not running. Did you enable server plugins in your config.yaml file?",t);if(!e.ok)return void console.error("Failed to register with ValueTracker:",t);console.log("Successfully registered with ValueTracker:",t.message)}catch(e){console.error("Error registering with ValueTracker:",e)}})),b="outfit_extension",E=Object.freeze({enabled:!1,debugMode:!1});function S(){const e=SillyTavern.getContext().extensionSettings;e[b]||(e[b]=structuredClone(E));for(const t of Object.keys(E))t in e[b]||(e[b][t]=E[t]);return e[b]}h(void 0,void 0,void 0,(function*(){if("undefined"!=typeof SillyTavern&&SillyTavern.getContext){const e=SillyTavern.getContext(),{eventSource:t,event_types:n}=e;t.on(n.APP_READY,(()=>{console.log("Outfit Extension: App is ready"),S().enabled?(console.log("Outfit Extension: Initialized and enabled"),x()):console.log("Outfit Extension: Initialized but disabled")})),t.on(n.CHAT_CHANGED,(()=>{console.log("Outfit Extension: Chat changed")})),t.on(n.MESSAGE_RECEIVED,(e=>{console.log("Outfit Extension: Message received",e)})),t.on(n.MESSAGE_SENT,(e=>{console.log("Outfit Extension: Message sent",e)})),console.log("Outfit Extension: Event listeners registered")}else console.error("SillyTavern context not available")})),void 0!==globalThis.SlashCommandParser&&void 0!==globalThis.SlashCommand&&(globalThis.SlashCommandParser.addCommandObject(globalThis.SlashCommand.fromProps({name:"outfit",callback:(e,t)=>S().enabled?`Outfit Extension is currently enabled. Command: ${t.toString()}`:"Outfit Extension is currently disabled.",aliases:["o"],returns:"outfit extension status",helpString:'\n                    <div>\n                        Outfit Extension command for testing purposes.\n                    </div>\n                    <div>\n                        <strong>Example:</strong>\n                        <ul>\n                            <li>\n                                <pre><code class="language-stscript">/outfit status</code></pre>\n                                returns the current status of the outfit extension\n                            </li>\n                        </ul>\n                    </div>\n                '})),console.log("Outfit Extension: Slash commands registered")),(()=>{const e='\n        <div id="outfit-extension-settings" style="display: none;">\n            <div class="inline-help">\n                <p>Configure the Outfit Extension settings here.</p>\n            </div>\n\n            <div class="checkbox-nested">\n                <label class="checkbox">\n                    <input type="checkbox" id="outfit-extension-enabled" name="enabled">\n                    <span>Enable Outfit Extension</span>\n                </label>\n            </div>\n\n            <div class="checkbox-nested">\n                <label class="checkbox">\n                    <input type="checkbox" id="outfit-extension-debug" name="debugMode">\n                    <span>Debug Mode</span>\n                </label>\n            </div>\n        </div>\n    ',t=()=>{const t=[document.getElementById("settingsDiv"),document.querySelector("#settingsDiv"),document.querySelector("#settings-menu"),document.body];let n=null;for(const e of t)if(e){n=e;break}if(n){n.insertAdjacentHTML("beforeend",e);const t=S(),o=document.getElementById("outfit-extension-enabled"),i=document.getElementById("outfit-extension-debug");o&&i&&(o.checked=t.enabled,i.checked=t.debugMode,o.addEventListener("change",(()=>{t.enabled=o.checked,SillyTavern.getContext().saveSettingsDebounced(),t.enabled&&x()})),i.addEventListener("change",(()=>{t.debugMode=i.checked,SillyTavern.getContext().saveSettingsDebounced()})));const s=document.getElementById("settingsMenuExtensionItems");if(s){const e=document.createElement("A");e.setAttribute("data-target","outfit-extension-settings"),e.textContent=y,e.href="javascript:void(0)",s.appendChild(e)}else{const t=document.querySelector("#nav-settings");if(t){let e=document.querySelector("#extension-nav-items");e||(e=document.createElement("div"),e.id="extension-nav-items",e.classList.add("settingsGroup"),t.appendChild(e));const n=document.createElement("A");n.setAttribute("data-target","outfit-extension-settings"),n.textContent=y,n.href="javascript:void(0)",e.appendChild(n)}else{const t=document.querySelector("#settingsMenu .settingsGroup");if(t){const e=document.createElement("A");e.setAttribute("data-target","outfit-extension-settings"),e.textContent=y,e.href="javascript:void(0)",t.appendChild(e)}else{const t=document.querySelector(".dialoguePopupBackdrop.settings");if(t){let e=document.querySelector(".extension-settings-links");e||(e=document.createElement("div"),e.className="extension-settings-links",e.style.borderTop="1px solid #999",e.style.paddingTop="10px",e.style.marginTop="10px",t.appendChild(e));const n=document.createElement("A");n.setAttribute("data-target","outfit-extension-settings"),n.textContent=y,n.href="javascript:void(0)",n.style.display="block",n.style.margin="5px 0",e.appendChild(n)}else{console.warn(`Could not find standard settings navigation container for ${y}`);const t=document.querySelector("#manage-extensions-content");if(t){const n=document.createElement("div");n.innerHTML=`\n                                    <details class="settings-list-item">\n                                        <summary class="list-header">\n                                            <span class="list-title">${y} Settings</span>\n                                        </summary>\n                                        <div class="list-content">\n                                            ${e}\n                                        </div>\n                                    </details>\n                                `,t.appendChild(n);const o=S(),i=n.querySelector("#outfit-extension-enabled"),s=n.querySelector("#outfit-extension-debug");i&&s&&(i.checked=o.enabled,s.checked=o.debugMode,i.addEventListener("change",(()=>{o.enabled=i.checked,SillyTavern.getContext().saveSettingsDebounced(),o.enabled&&x()})),s.addEventListener("change",(()=>{o.debugMode=s.checked,SillyTavern.getContext().saveSettingsDebounced()})))}}}}}console.log("Outfit Extension: Settings panel registered")}else console.warn("Could not find any settings container for Outfit Extension, deferring...")};if(t(),"undefined"!=typeof SillyTavern&&SillyTavern.getContext){const e=SillyTavern.getContext();if(e&&e.eventSource){e.eventSource.on(e.event_types.APP_READY,t);new MutationObserver((e=>{for(const n of e)if("childList"===n.type){if(Array.from(n.addedNodes).some((e=>e.nodeType===Node.ELEMENT_NODE&&e.matches&&(e.matches('[id*="settings" i]')||e.matches('[class*="settings" i]'))))){setTimeout(t,100);break}}})).observe(document.body,{childList:!0,subtree:!0})}}})(),console.log(`${y}: Initialization complete`)})();